# 跨平台兼容性修復計劃

## 🎯 **發現的問題**

### 1. **依賴項引用錯誤**
- 當前：`'<!(node -p "require(\'node-addon-api\').gyp")'`
- 應該：`'node-addon-api'` 或者直接包含

### 2. **硬編碼路徑問題**
- `src/3rdparty/hwloc_x64-windows/lib/hwloc.lib` - 只能用在 Windows x64
- 需要根據架構和平台動態選擇

### 3. **平台特定問題**
- Windows 環境的 DLL 依賴
- 不同平台的編譯器標記
- ARM vs x86 架構差異

## 🔧 **修復策略**

### 1. **重構 binding.gyp**
- 動態路徑檢測
- 平台/架構感知配置
- 正確的 node-addon-api 引用

### 2. **架構感知編譯**
- ARM64 vs x64 vs x86
- 平台特定優化旗標
- 自動檢測可用的 CPU 功能

### 3. **依賴管理**
- Windows: 動態庫管理
- Linux: 系統庫依賴
- macOS: Framework 依賴

## 📋 **具體修復步驟**

1. 修復 binding.gyp 路徑和依賴
2. 添加架構檢測邏輯  
3. 修正 C++ binding 實現
4. 創建平台特定配置
5. 測試各平台編譯